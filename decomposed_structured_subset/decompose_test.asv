m = 5;
nBlk = 10;
BlkSize = 1;
ArrowHead = 1;
r = 4;
num_c = 1;


[model.At,model.b,model.c,model.K, X_star] = blockArrowRank(m,nBlk,BlkSize,ArrowHead, r, num_c);

%chordal decomposition
[cl, Ech, Jch, usedvars, s] = chordalDecomposition(model.At(K.f+1:end, cons), model.c(K.f+1:end), K);

cliques = {};
cl_ind = 0;
idx = (1:K.f)';

for i = 1:(cl{1,1}.NoC)
    cli = cl{1 ,1}.Elem (cl_ind + (1:cl{1,1}.NoElem(i)));
    cl_ind = cl_ind + cl{1,1}.NoElem(i);
    cliques{i} =  cli;
    idxi = reshape(cli +  K.s*(cli-1)' + K.f, [],1 );
    idx = [idx; idxi];
    if i ==1
        idx0 = idxi;
    end
end

Ats = At(K.f+1:end, cons);
cs = c(K.f+1:end);

model_agler.K.f = K.f;
model_agler.K.l = 0;
model_agler.K.q = [];
model_agler.K.s = cellfun(@length, cliques);
model_agler.pars = pars;
 
numvar = K.f + sum(model_agler.K.s .^2);

model_agler.At = At(idx, :);
model_agler.b = b;
model_agler.c  = c(idx);


cone = 'dd';
[model_dd.At,model_dd.b,model_dd.c,model_dd.K, info] = ...
    decomposed_subset(model.A, model.b, model.c, model.K, cone);

[model_cdd.At,model_dd.b,model_dd.c,model_dd.K, info] = ...
    = decomposed_subset(model_agler.A, model_agler.b, model_agler.c, model_agler.K, cone);


